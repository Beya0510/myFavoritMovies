@using Favies.Services
@using Favies.Models
@inject GetMoviesService GetMoviesService
@inject FavoritesService FavoritesService


<h3>Data from API</h3>

@if (data == null)
{
    <p>Loading...</p>
}
else
{
    <ul>
        @foreach (var item in data)
        {
            <li>
                @item.Title
                <button @onclick="() => AddToFavorites(item.Title)">Add to Favorites</button>
                <button @onclick="() => RemoveFromFavorites(item.Title)">Remove from Favorites</button>
            </li>
        }
    </ul>
}

<h3>Favorites</h3>
<ul>
    @foreach (var favorite in FavoritesService.GetFavorites())
    {
        <li>@favorite</li>
    }
</ul>

@code {
    private List<Movie>? data; // DÃ©clarer comme nullable

    protected override async Task OnInitializedAsync()
    {
        data = (await GetMoviesService.GetMoviesAsync("Inception")).ToList(); // Conversion explicite en List<Movie>
    }

    private void AddToFavorites(string item)
    {
        FavoritesService.AddFavorite(item);
    }

    private void RemoveFromFavorites(string item)
    {
        FavoritesService.RemoveFavorite(item);
    }
}